var xt=Object.defineProperty;var Mt=(r,n,t)=>n in r?xt(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t;var b=(r,n,t)=>(Mt(r,typeof n!="symbol"?n+"":n,t),t);import{r as y,v as m,j as c,n as F,e as M,q as Ze,F as ke,l as Ce}from"./vendor.1a13863b.js";import{l as at,c as K,P as Rt,I as Z,C as St,u as kt,a as ot,b as Ot,d as Oe,e as Ge,E as Dt}from"./index.a064b8da.js";var Te={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.COLUMN_DEFS=r.extractColumns=void 0;const n=at;function t(e){const i={};for(const[a,o]of Object.entries(e))i[a]=r.COLUMN_DEFS[o];return n.z.array(n.z.object(i))}r.extractColumns=t,r.COLUMN_DEFS={number:n.z.number(),"number?":n.z.number().nullable(),string:n.z.string(),"string?":n.z.string().nullable(),boolean:n.z.boolean(),"boolean?":n.z.boolean().nullable()}})(Te);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Je=Object.getOwnPropertySymbols,Nt=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable;function Tt(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function Pt(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;var e=Object.getOwnPropertyNames(n).map(function(a){return n[a]});if(e.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var z=Pt()?Object.assign:function(r,n){for(var t,e=Tt(r),i,a=1;a<arguments.length;a++){t=Object(arguments[a]);for(var o in t)Nt.call(t,o)&&(e[o]=t[o]);if(Je){i=Je(t);for(var s=0;s<i.length;s++)Lt.call(t,i[s])&&(e[i[s]]=t[i[s]])}}return e};function H(r){for(var n=arguments.length,t=new Array(n>1?n-1:0),e=1;e<n;e++)t[e-1]=arguments[e];return typeof r=="function"&&r(...t)}function re(r,n){return Object.prototype.hasOwnProperty.call(r,n)}function jt(){return Math.random().toString(36).substring(7)}const P={menu:"react-contextmenu",menuVisible:"react-contextmenu--visible",menuWrapper:"react-contextmenu-wrapper",menuItem:"react-contextmenu-item",menuItemActive:"react-contextmenu-item--active",menuItemDisabled:"react-contextmenu-item--disabled",menuItemDivider:"react-contextmenu-item--divider",menuItemSelected:"react-contextmenu-item--selected",subMenu:"react-contextmenu-submenu"},te={},It=Boolean(typeof window<"u"&&window.document&&window.document.createElement),De="REACT_CONTEXTMENU_SHOW",Ne="REACT_CONTEXTMENU_HIDE";function st(r,n){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window,e;typeof window.CustomEvent=="function"?e=new window.CustomEvent(r,{detail:n}):(e=document.createEvent("CustomEvent"),e.initCustomEvent(r,!1,!0,n)),t&&(t.dispatchEvent(e),z(te,n))}function Qe(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;st(De,z({},r,{type:De}),n)}function ie(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;st(Ne,z({},r,{type:Ne}),n)}class $t{constructor(){b(this,"handleShowEvent",n=>{for(const t in this.callbacks)re(this.callbacks,t)&&this.callbacks[t].show(n)});b(this,"handleHideEvent",n=>{for(const t in this.callbacks)re(this.callbacks,t)&&this.callbacks[t].hide(n)});b(this,"register",(n,t)=>{const e=jt();return this.callbacks[e]={show:n,hide:t},e});b(this,"unregister",n=>{n&&this.callbacks[n]&&delete this.callbacks[n]});this.callbacks={},It&&(window.addEventListener(De,this.handleShowEvent),window.addEventListener(Ne,this.handleHideEvent))}}const be=new $t;class ee extends y.exports.Component{constructor(){super(...arguments);b(this,"handleClick",t=>{t.button!==0&&t.button!==1&&t.preventDefault(),!(this.props.disabled||this.props.divider)&&(H(this.props.onClick,t,z({},this.props.data,te.data),te.target),!this.props.preventClose&&ie())})}render(){const{attributes:t,children:e,className:i,disabled:a,divider:o,selected:s,role:l}=this.props,p=K(i,P.menuItem,t.className,{[K(P.menuItemDisabled,t.disabledClassName)]:a,[K(P.menuItemDivider,t.dividerClassName)]:o,[K(P.menuItemSelected,t.selectedClassName)]:s});return c("div",{...t,className:p,role:l,tabIndex:"-1","aria-disabled":a?"true":"false","aria-orientation":o?"horizontal":null,ref:f=>{this.ref=f},onMouseMove:this.props.onMouseMove,onMouseLeave:this.props.onMouseLeave,onTouchEnd:this.handleClick,onClick:this.handleClick,children:o?null:e})}}b(ee,"propTypes",{attributes:m.exports.object,children:m.exports.node,className:m.exports.string,data:m.exports.object,disabled:m.exports.bool,divider:m.exports.bool,onClick:m.exports.func,onMouseLeave:m.exports.func,onMouseMove:m.exports.func,preventClose:m.exports.bool,selected:m.exports.bool,role:m.exports.string}),b(ee,"defaultProps",{attributes:{},children:null,className:"",data:{},disabled:!1,divider:!1,onClick(){return null},onMouseMove:()=>null,onMouseLeave:()=>null,preventClose:!1,selected:!1,role:"menuitem"});class Pe extends y.exports.Component{constructor(t){super(t);b(this,"handleKeyNavigation",t=>{if(this.state.isVisible!==!1)switch(t.key){case"ArrowLeft":case"Left":case"Escape":case"Esc":t.preventDefault(),this.hideMenu(t);break;case"ArrowUp":case"Up":t.preventDefault(),this.selectChildren(!0);break;case"ArrowDown":case"Down":t.preventDefault(),this.selectChildren(!1);break;case"ArrowRight":case"Right":this.tryToOpenSubMenu(t);break;case"Enter":t.preventDefault(),this.tryToOpenSubMenu(t);{const e=this.seletedItemRef&&this.seletedItemRef.props&&this.seletedItemRef.props.disabled;this.seletedItemRef&&this.seletedItemRef.ref instanceof HTMLElement&&!e?this.seletedItemRef.ref.click():this.hideMenu(t)}break}});b(this,"handleForceClose",()=>{this.setState({forceSubMenuOpen:!1})});b(this,"tryToOpenSubMenu",t=>{this.state.selectedItem&&this.state.selectedItem.type===this.getSubMenuType()&&(t.preventDefault(),this.setState({forceSubMenuOpen:!0}))});b(this,"selectChildren",t=>{const{selectedItem:e}=this.state,i=[];let a=0,o={};const s=(d,u)=>{!d||([ee,this.getSubMenuType()].indexOf(d.type)<0?F.Children.forEach(d.props.children,s):d.props.divider||(d.props.disabled&&(++a,o[u]=!0),i.push(d)))};if(F.Children.forEach(this.props.children,s),a===i.length)return;function l(d){let u=d,v=()=>{t?--u:++u,u<0?u=i.length-1:u>=i.length&&(u=0)};do v();while(u!==d&&o[u]);return u===d?null:u}const p=e?e.index:-1,f=l(p);f!==null&&this.setState({selectedItem:{index:f,type:i[f].type},forceSubMenuOpen:!1})});b(this,"onChildMouseMove",(t,e)=>{(this.state.selectedItem===null||this.state.selectedItem.index!==e)&&this.setState({selectedItem:{index:e,type:t.type},forceSubMenuOpen:!1})});b(this,"onChildMouseLeave",()=>{this.setState({selectedItem:null,forceSubMenuOpen:!1})});b(this,"renderChildren",(()=>{var t=this;return function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{value:-1};return F.Children.map(e,a=>{let o=i;const s={};if(!F.isValidElement(a))return a;if([ee,t.getSubMenuType()].indexOf(a.type)<0)return s.children=t.renderChildren(a.props.children,o),F.cloneElement(a,s);let l=null;return a.props.divider||(l=++o.value),s.onMouseLeave=t.onChildMouseLeave.bind(t),a.type===t.getSubMenuType()&&(s.forceOpen=t.state.forceSubMenuOpen&&t.state.selectedItem&&t.state.selectedItem.index===l,s.forceClose=t.handleForceClose,s.parentKeyNavigationHandler=t.handleKeyNavigation),!a.props.divider&&t.state.selectedItem&&t.state.selectedItem.index===l?(s.selected=!0,s.ref=p=>{t.seletedItemRef=p},F.cloneElement(a,s)):(s.onMouseMove=()=>t.onChildMouseMove(a,l),F.cloneElement(a,s))})}})());this.seletedItemRef=null,this.state={selectedItem:null,forceSubMenuOpen:!1}}}b(Pe,"propTypes",{children:m.exports.node.isRequired});const ze=class extends Pe{constructor(t){super(t);b(this,"getMenuPosition",()=>{const{innerWidth:t,innerHeight:e}=window,i=this.subMenu.getBoundingClientRect(),a={};return i.bottom>e?a.bottom=0:a.top=0,i.right<t?a.left="100%":a.right="100%",a});b(this,"getRTLMenuPosition",()=>{const{innerHeight:t}=window,e=this.subMenu.getBoundingClientRect(),i={};return e.bottom>t?i.bottom=0:i.top=0,e.left<0?i.left="100%":i.right="100%",i});b(this,"hideMenu",t=>{t.preventDefault(),this.hideSubMenu(t)});b(this,"hideSubMenu",t=>{t.detail&&t.detail.id&&this.menu&&t.detail.id!==this.menu.id||(this.props.forceOpen&&this.props.forceClose(),this.setState({visible:!1,selectedItem:null}),this.unregisterHandlers())});b(this,"handleClick",t=>{t.preventDefault(),!this.props.disabled&&(H(this.props.onClick,t,z({},this.props.data,te.data),te.target),!(!this.props.onClick||this.props.preventCloseOnClick)&&ie())});b(this,"handleMouseEnter",()=>{this.closetimer&&clearTimeout(this.closetimer),!(this.props.disabled||this.state.visible)&&(this.opentimer=setTimeout(()=>this.setState({visible:!0,selectedItem:null}),this.props.hoverDelay))});b(this,"handleMouseLeave",()=>{this.opentimer&&clearTimeout(this.opentimer),this.state.visible&&(this.closetimer=setTimeout(()=>this.setState({visible:!1,selectedItem:null}),this.props.hoverDelay))});b(this,"menuRef",t=>{this.menu=t});b(this,"subMenuRef",t=>{this.subMenu=t});b(this,"registerHandlers",()=>{document.removeEventListener("keydown",this.props.parentKeyNavigationHandler),document.addEventListener("keydown",this.handleKeyNavigation)});b(this,"unregisterHandlers",t=>{document.removeEventListener("keydown",this.handleKeyNavigation),t||document.addEventListener("keydown",this.props.parentKeyNavigationHandler)});this.state=z({},this.state,{visible:!1})}componentDidMount(){this.listenId=be.register(()=>{},this.hideSubMenu)}getSubMenuType(){return ze}shouldComponentUpdate(t,e){return this.isVisibilityChange=(this.state.visible!==e.visible||this.props.forceOpen!==t.forceOpen)&&!(this.state.visible&&t.forceOpen)&&!(this.props.forceOpen&&e.visible),!0}componentDidUpdate(){if(!!this.isVisibilityChange)if(this.props.forceOpen||this.state.visible)(window.requestAnimationFrame||setTimeout)(()=>{const e=this.props.rtl?this.getRTLMenuPosition():this.getMenuPosition();this.subMenu.style.removeProperty("top"),this.subMenu.style.removeProperty("bottom"),this.subMenu.style.removeProperty("left"),this.subMenu.style.removeProperty("right"),re(e,"top")&&(this.subMenu.style.top=e.top),re(e,"left")&&(this.subMenu.style.left=e.left),re(e,"bottom")&&(this.subMenu.style.bottom=e.bottom),re(e,"right")&&(this.subMenu.style.right=e.right),this.subMenu.classList.add(P.menuVisible),this.registerHandlers(),this.setState({selectedItem:null})});else{const t=()=>{this.subMenu.removeEventListener("transitionend",t),this.subMenu.style.removeProperty("bottom"),this.subMenu.style.removeProperty("right"),this.subMenu.style.top=0,this.subMenu.style.left="100%",this.unregisterHandlers()};this.subMenu.addEventListener("transitionend",t),this.subMenu.classList.remove(P.menuVisible)}}componentWillUnmount(){this.listenId&&be.unregister(this.listenId),this.opentimer&&clearTimeout(this.opentimer),this.closetimer&&clearTimeout(this.closetimer),this.unregisterHandlers(!0)}render(){const{children:t,attributes:e,disabled:i,title:a,selected:o}=this.props,{visible:s}=this.state,l={ref:this.menuRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,className:K(P.menuItem,P.subMenu,e.listClassName),style:{position:"relative"}},p={className:K(P.menuItem,e.className,{[K(P.menuItemDisabled,e.disabledClassName)]:i,[K(P.menuItemActive,e.visibleClassName)]:s,[K(P.menuItemSelected,e.selectedClassName)]:o}),onMouseMove:this.props.onMouseMove,onMouseOut:this.props.onMouseOut,onClick:this.handleClick},f={ref:this.subMenuRef,style:{position:"absolute",transition:"opacity 1ms",top:0,left:"100%"},className:K(P.menu,this.props.className)};return M("nav",{...l,role:"menuitem",tabIndex:"-1","aria-haspopup":"true",children:[c("div",{...e,...p,children:a}),c("nav",{...f,role:"menu",tabIndex:"-1",children:this.renderChildren(t)})]})}};let ue=ze;b(ue,"propTypes",{children:m.exports.node.isRequired,attributes:m.exports.object,title:m.exports.node.isRequired,className:m.exports.string,disabled:m.exports.bool,hoverDelay:m.exports.number,rtl:m.exports.bool,selected:m.exports.bool,onMouseMove:m.exports.func,onMouseOut:m.exports.func,forceOpen:m.exports.bool,forceClose:m.exports.func,parentKeyNavigationHandler:m.exports.func}),b(ue,"defaultProps",{disabled:!1,hoverDelay:500,attributes:{},className:"",rtl:!1,selected:!1,onMouseMove:()=>null,onMouseOut:()=>null,forceOpen:!1,forceClose:()=>null,parentKeyNavigationHandler:()=>null});function Kt(r){Ze.flushSync?Ze.flushSync(r):r()}class Le extends Pe{constructor(t){super(t);b(this,"registerHandlers",()=>{document.addEventListener("mousedown",this.handleOutsideClick),document.addEventListener("touchstart",this.handleOutsideClick),this.props.preventHideOnScroll||document.addEventListener("scroll",this.handleHide),this.props.preventHideOnContextMenu||document.addEventListener("contextmenu",this.handleHide),document.addEventListener("keydown",this.handleKeyNavigation),this.props.preventHideOnResize||window.addEventListener("resize",this.handleHide)});b(this,"unregisterHandlers",()=>{document.removeEventListener("mousedown",this.handleOutsideClick),document.removeEventListener("touchstart",this.handleOutsideClick),document.removeEventListener("scroll",this.handleHide),document.removeEventListener("contextmenu",this.handleHide),document.removeEventListener("keydown",this.handleKeyNavigation),window.removeEventListener("resize",this.handleHide)});b(this,"handleShow",t=>{if(t.detail.id!==this.props.id||this.state.isVisible)return;const{x:e,y:i}=t.detail.position;this.setState({isVisible:!0,x:e,y:i}),this.registerHandlers(),H(this.props.onShow,t)});b(this,"handleHide",t=>{this.state.isVisible&&(!t.detail||!t.detail.id||t.detail.id===this.props.id)&&(this.unregisterHandlers(),Kt(()=>{this.setState({isVisible:!1,selectedItem:null,forceSubMenuOpen:!1})}),H(this.props.onHide,t))});b(this,"handleOutsideClick",t=>{this.menu.contains(t.target)||ie()});b(this,"handleMouseLeave",t=>{t.preventDefault(),H(this.props.onMouseLeave,t,z({},this.props.data,te.data),te.target),this.props.hideOnLeave&&ie()});b(this,"handleContextMenu",t=>{t.preventDefault(),this.handleHide(t)});b(this,"hideMenu",t=>{(t.key==="Escape"||t.key==="Esc"||t.key==="Enter")&&ie()});b(this,"getMenuPosition",(()=>{var t=this;return function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a={top:i,left:e};if(!t.menu)return a;const{innerWidth:o,innerHeight:s}=window,l=t.menu.getBoundingClientRect();return i+l.height>s&&(a.top-=l.height),e+l.width>o&&(a.left-=l.width),a.top<0&&(a.top=l.height<s?(s-l.height)/2:0),a.left<0&&(a.left=l.width<o?(o-l.width)/2:0),a}})());b(this,"getRTLMenuPosition",(()=>{var t=this;return function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a={top:i,left:e};if(!t.menu)return a;const{innerWidth:o,innerHeight:s}=window,l=t.menu.getBoundingClientRect();return a.left=e-l.width,i+l.height>s&&(a.top-=l.height),a.left<0&&(a.left+=l.width),a.top<0&&(a.top=l.height<s?(s-l.height)/2:0),a.left+l.width>o&&(a.left=l.width<o?(o-l.width)/2:0),a}})());b(this,"menuRef",t=>{this.menu=t});this.state=z({},this.state,{x:0,y:0,isVisible:!1})}getSubMenuType(){return ue}componentDidMount(){this.listenId=be.register(this.handleShow,this.handleHide)}componentDidUpdate(){const t=window.requestAnimationFrame||setTimeout;this.state.isVisible?t(()=>{const{x:e,y:i}=this.state,{top:a,left:o}=this.props.rtl?this.getRTLMenuPosition(e,i):this.getMenuPosition(e,i);t(()=>{!this.menu||(this.menu.style.top=`${a}px`,this.menu.style.left=`${o}px`,this.menu.style.opacity=1,this.menu.style.pointerEvents="auto")})}):t(()=>{!this.menu||(this.menu.style.opacity=0,this.menu.style.pointerEvents="none")})}componentWillUnmount(){this.listenId&&be.unregister(this.listenId),this.unregisterHandlers()}render(){const{children:t,className:e,style:i}=this.props,{isVisible:a}=this.state,o=z({},i,{position:"fixed",opacity:0,pointerEvents:"none"}),s=K(P.menu,e,{[P.menuVisible]:a});return c("nav",{role:"menu",tabIndex:"-1",ref:this.menuRef,style:o,className:s,onContextMenu:this.handleContextMenu,onMouseLeave:this.handleMouseLeave,children:this.renderChildren(t)})}}b(Le,"propTypes",{id:m.exports.string.isRequired,children:m.exports.node.isRequired,data:m.exports.object,className:m.exports.string,hideOnLeave:m.exports.bool,rtl:m.exports.bool,onHide:m.exports.func,onMouseLeave:m.exports.func,onShow:m.exports.func,preventHideOnContextMenu:m.exports.bool,preventHideOnResize:m.exports.bool,preventHideOnScroll:m.exports.bool,style:m.exports.object}),b(Le,"defaultProps",{className:"",data:{},hideOnLeave:!1,rtl:!1,onHide(){return null},onMouseLeave(){return null},onShow(){return null},preventHideOnContextMenu:!1,preventHideOnResize:!1,preventHideOnScroll:!1,style:{}});class ye extends y.exports.Component{constructor(){super(...arguments);b(this,"touchHandled",!1);b(this,"handleMouseDown",t=>{this.props.holdToDisplay>=0&&t.button===0&&(t.persist(),t.stopPropagation(),this.mouseDownTimeoutId=setTimeout(()=>this.handleContextClick(t),this.props.holdToDisplay)),H(this.props.attributes.onMouseDown,t)});b(this,"handleMouseUp",t=>{t.button===0&&clearTimeout(this.mouseDownTimeoutId),H(this.props.attributes.onMouseUp,t)});b(this,"handleMouseOut",t=>{t.button===0&&clearTimeout(this.mouseDownTimeoutId),H(this.props.attributes.onMouseOut,t)});b(this,"handleTouchstart",t=>{this.touchHandled=!1,this.props.holdToDisplay>=0&&(t.persist(),t.stopPropagation(),this.touchstartTimeoutId=setTimeout(()=>{this.handleContextClick(t),this.touchHandled=!0},this.props.holdToDisplay)),H(this.props.attributes.onTouchStart,t)});b(this,"handleTouchEnd",t=>{this.touchHandled&&t.preventDefault(),clearTimeout(this.touchstartTimeoutId),H(this.props.attributes.onTouchEnd,t)});b(this,"handleContextMenu",t=>{this.handleContextClick(t),H(this.props.attributes.onContextMenu,t)});b(this,"handleMouseClick",t=>{this.handleContextClick(t),H(this.props.attributes.onClick,t)});b(this,"handleContextClick",t=>{if(this.props.disable||this.props.disableIfShiftIsPressed&&t.shiftKey)return;t.preventDefault(),t.stopPropagation();let e=t.clientX||t.touches&&t.touches[0].pageX,i=t.clientY||t.touches&&t.touches[0].pageY;this.props.posX&&(e-=this.props.posX),this.props.posY&&(i-=this.props.posY),ie();let a=H(this.props.collect,this.props),o={position:{x:e,y:i},target:this.elem,id:this.props.id};a&&typeof a.then=="function"?a.then(s=>{o.data=z({},s,{target:t.target}),Qe(o)}):(o.data=z({},a,{target:t.target}),Qe(o))});b(this,"elemRef",t=>{this.elem=t})}render(){const{renderTag:t,attributes:e,children:i,triggerOnLeftClick:a}=this.props,o={...e,className:K(P.menuWrapper,e.className),onContextMenu:this.handleContextMenu,onClick:a?this.handleMouseClick:null,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onTouchStart:this.handleTouchstart,onTouchEnd:this.handleTouchEnd,onMouseOut:this.handleMouseOut,ref:this.elemRef};return F.createElement(t,o,i)}}b(ye,"propTypes",{id:m.exports.string.isRequired,children:m.exports.node.isRequired,attributes:m.exports.object,collect:m.exports.func,disable:m.exports.bool,holdToDisplay:m.exports.number,posX:m.exports.number,posY:m.exports.number,renderTag:m.exports.elementType,triggerOnLeftClick:m.exports.bool,disableIfShiftIsPressed:m.exports.bool}),b(ye,"defaultProps",{attributes:{},collect(){return null},disable:!1,holdToDisplay:1e3,renderTag:"div",posX:0,posY:0,triggerOnLeftClick:!1,disableIfShiftIsPressed:!1});[...Object.keys(ye.propTypes)];var j={},je={},ge={};Object.defineProperty(ge,"__esModule",{value:!0});var Vt=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),lt=y.exports,et=ut(lt),At=m.exports,tt=ut(At);function ut(r){return r&&r.__esModule?r:{default:r}}function qt(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function Ht(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function Ut(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}var dt=function(r){Ut(n,r);function n(){return qt(this,n),Ht(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return Vt(n,[{key:"render",value:function(){return et.default.createElement("table",{className:this.props.className},et.default.createElement("tbody",null,this.props.children))}}]),n}(lt.PureComponent);dt.propTypes={className:tt.default.string,data:tt.default.array.isRequired};ge.default=dt;var we={},ne={};Object.defineProperty(ne,"__esModule",{value:!0});var Yt=m.exports,T=zt(Yt);function zt(r){return r&&r.__esModule?r:{default:r}}var Ft={readOnly:T.default.bool,key:T.default.string,className:T.default.string,component:T.default.oneOfType([T.default.element,T.default.func]),forceComponent:T.default.bool,disableEvents:T.default.bool,disableUpdatedFlag:T.default.bool,colSpan:T.default.number,rowSpan:T.default.number,width:T.default.oneOfType([T.default.number,T.default.string]),overflow:T.default.oneOf(["wrap","nowrap","clip"]),dataEditor:T.default.func,valueViewer:T.default.func};ne.default=Ft;Object.defineProperty(we,"__esModule",{value:!0});var Bt=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),ct=y.exports,Wt=Ie(ct),Xt=m.exports,Ee=Ie(Xt),Zt=ne,Gt=Ie(Zt);function Ie(r){return r&&r.__esModule?r:{default:r}}function Jt(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function Qt(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function en(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}var ft=function(r){en(n,r);function n(){return Jt(this,n),Qt(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return Bt(n,[{key:"render",value:function(){return Wt.default.createElement("tr",null,this.props.children)}}]),n}(ct.PureComponent);ft.propTypes={row:Ee.default.number.isRequired,cells:Ee.default.arrayOf(Ee.default.shape(Gt.default)).isRequired};we.default=ft;var ce={};Object.defineProperty(ce,"__esModule",{value:!0});var tn=Object.assign||function(r){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}return r},nn=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),ht=y.exports,rn=$e(ht),an=m.exports,A=$e(an),on=ne,sn=$e(on);function $e(r){return r&&r.__esModule?r:{default:r}}function ln(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function un(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function dn(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}var Ke=function(r){dn(n,r);function n(){return ln(this,n),un(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return nn(n,[{key:"render",value:function(){var e=this.props,i=e.cell,a=e.row,o=e.col,s=e.attributesRenderer,l=e.className,p=e.style,f=e.onMouseDown,d=e.onMouseOver,u=e.onDoubleClick,v=e.onContextMenu,h=i.colSpan,w=i.rowSpan,R=s?s(i,a,o):{};return rn.default.createElement("td",tn({className:l,onMouseDown:f,onMouseOver:d,onDoubleClick:u,onTouchEnd:u,onContextMenu:v,colSpan:h,rowSpan:w,style:p},R),this.props.children)}}]),n}(ht.PureComponent);ce.default=Ke;Ke.propTypes={row:A.default.number.isRequired,col:A.default.number.isRequired,cell:A.default.shape(sn.default).isRequired,selected:A.default.bool,editing:A.default.bool,updated:A.default.bool,attributesRenderer:A.default.func,onMouseDown:A.default.func.isRequired,onMouseOver:A.default.func.isRequired,onDoubleClick:A.default.func.isRequired,onContextMenu:A.default.func.isRequired,className:A.default.string,style:A.default.object};Ke.defaultProps={selected:!1,editing:!1,updated:!1,attributesRenderer:function(){}};var Ve={},U={};Object.defineProperty(U,"__esModule",{value:!0});U.TAB_KEY=9;U.ENTER_KEY=13;U.ESCAPE_KEY=27;U.LEFT_KEY=37;U.UP_KEY=38;U.RIGHT_KEY=39;U.DOWN_KEY=40;U.DELETE_KEY=46;U.BACKSPACE_KEY=8;var fe={};Object.defineProperty(fe,"__esModule",{value:!0});var cn=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),pt=y.exports,fn=Ae(pt),hn=m.exports,G=Ae(hn),pn=ne,mn=Ae(pn);function Ae(r){return r&&r.__esModule?r:{default:r}}function vn(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function bn(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function yn(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}var mt=function(r){yn(n,r);function n(t){vn(this,n);var e=bn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.handleChange=e.handleChange.bind(e),e}return cn(n,[{key:"componentDidMount",value:function(){this._input.focus()}},{key:"handleChange",value:function(e){this.props.onChange(e.target.value)}},{key:"render",value:function(){var e=this,i=this.props,a=i.value,o=i.onKeyDown;return fn.default.createElement("input",{ref:function(l){e._input=l},className:"data-editor",value:a,onChange:this.handleChange,onKeyDown:o})}}]),n}(pt.PureComponent);fe.default=mt;mt.propTypes={value:G.default.node.isRequired,row:G.default.number.isRequired,col:G.default.number.isRequired,cell:G.default.shape(mn.default),onChange:G.default.func.isRequired,onCommit:G.default.func.isRequired,onRevert:G.default.func.isRequired,onKeyDown:G.default.func.isRequired};var he={};Object.defineProperty(he,"__esModule",{value:!0});var gn=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),vt=y.exports,wn=qe(vt),Cn=m.exports,me=qe(Cn),En=ne,_n=qe(En);function qe(r){return r&&r.__esModule?r:{default:r}}function xn(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function Mn(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function Rn(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}var bt=function(r){Rn(n,r);function n(){return xn(this,n),Mn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return gn(n,[{key:"render",value:function(){var e=this.props.value;return wn.default.createElement("span",{className:"value-viewer"},e)}}]),n}(vt.PureComponent);he.default=bt;bt.propTypes={row:me.default.number.isRequired,col:me.default.number.isRequired,cell:me.default.shape(_n.default),value:me.default.node.isRequired};var pe={};Object.defineProperty(pe,"__esModule",{value:!0});pe.renderValue=yt;pe.renderData=Sn;function yt(r,n,t,e){var i=e(r,n,t);return i===null||typeof i>"u"?"":i}function Sn(r,n,t,e,i){var a=i?i(r,n,t):null;return a===null||typeof a>"u"?yt(r,n,t,e):a}Object.defineProperty(Ve,"__esModule",{value:!0});var kn=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),gt=y.exports,_e=ae(gt),On=m.exports,O=ae(On),Q=U,Dn=ce,Nn=ae(Dn),Ln=ne,Tn=ae(Ln),Pn=fe,jn=ae(Pn),In=he,$n=ae(In),He=pe;function ae(r){return r&&r.__esModule?r:{default:r}}function Kn(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function Vn(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function An(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}function xe(r){var n=r.cell,t=r.row,e=r.col,i=r.valueRenderer,a=r.dataRenderer;return(0,He.renderData)(n,t,e,i,a)}function nt(r){var n=r.cell,t=r.row,e=r.col,i=r.valueRenderer;return(0,He.renderValue)(n,t,e,i)}function qn(r){var n=typeof r.width=="number"?r.width+"px":r.width;return n?{width:n}:null}var Ue=function(r){An(n,r);function n(t){Kn(this,n);var e=Vn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.handleChange=e.handleChange.bind(e),e.handleCommit=e.handleCommit.bind(e),e.handleRevert=e.handleRevert.bind(e),e.handleKey=e.handleKey.bind(e),e.handleMouseDown=e.handleMouseDown.bind(e),e.handleMouseOver=e.handleMouseOver.bind(e),e.handleContextMenu=e.handleContextMenu.bind(e),e.handleDoubleClick=e.handleDoubleClick.bind(e),e.state={updated:!1,reverting:!1,committing:!1,value:""},e}return kn(n,[{key:"componentDidUpdate",value:function(e){var i=this;if(!this.props.cell.disableUpdatedFlag&&nt(e)!==nt(this.props)&&(this.setState({updated:!0}),this.timeout=setTimeout(function(){return i.setState({updated:!1})},700)),this.props.editing===!0&&e.editing===!1){var a=this.props.clearing?"":xe(this.props);this.setState({value:a,reverting:!1})}e.editing===!0&&this.props.editing===!1&&!this.state.reverting&&!this.state.committing&&this.state.value!==xe(this.props)&&this.props.onChange(this.props.row,this.props.col,this.state.value)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"handleChange",value:function(e){this.setState({value:e,committing:!1})}},{key:"handleCommit",value:function(e,i){var a=this.props,o=a.onChange,s=a.onNavigate;e!==xe(this.props)?(this.setState({value:e,committing:!0}),o(this.props.row,this.props.col,e)):this.handleRevert(),i&&(i.preventDefault(),s(i,!0))}},{key:"handleRevert",value:function(){this.setState({reverting:!0}),this.props.onRevert()}},{key:"handleMouseDown",value:function(e){var i=this.props,a=i.row,o=i.col,s=i.onMouseDown,l=i.cell;l.disableEvents||s(a,o,e)}},{key:"handleMouseOver",value:function(e){var i=this.props,a=i.row,o=i.col,s=i.onMouseOver,l=i.cell;l.disableEvents||s(a,o)}},{key:"handleDoubleClick",value:function(e){var i=this.props,a=i.row,o=i.col,s=i.onDoubleClick,l=i.cell;l.disableEvents||s(a,o)}},{key:"handleContextMenu",value:function(e){var i=this.props,a=i.row,o=i.col,s=i.onContextMenu,l=i.cell;l.disableEvents||s(e,a,o)}},{key:"handleKey",value:function(e){var i=e.which||e.keyCode;if(i===Q.ESCAPE_KEY)return this.handleRevert();var a=this.props,o=a.cell.component,s=a.forceEdit,l=s||!!o,p=i===Q.ENTER_KEY||i===Q.TAB_KEY||!l&&[Q.LEFT_KEY,Q.RIGHT_KEY,Q.UP_KEY,Q.DOWN_KEY].includes(i);p&&this.handleCommit(this.state.value,e)}},{key:"renderComponent",value:function(e,i){var a=i.component,o=i.readOnly,s=i.forceComponent;if(e&&!o||s)return a}},{key:"renderEditor",value:function(e,i,a,o,s){if(e){var l=i.dataEditor||s||jn.default;return _e.default.createElement(l,{cell:i,row:a,col:o,value:this.state.value,onChange:this.handleChange,onCommit:this.handleCommit,onRevert:this.handleRevert,onKeyDown:this.handleKey})}}},{key:"renderViewer",value:function(e,i,a,o,s){var l=e.valueViewer||s||$n.default,p=(0,He.renderValue)(e,i,a,o);return _e.default.createElement(l,{cell:e,row:i,col:a,value:p})}},{key:"render",value:function(){var e=this.props,i=e.row,a=e.col,o=e.cell,s=e.cellRenderer,l=e.valueRenderer,p=e.dataEditor,f=e.valueViewer,d=e.attributesRenderer,u=e.selected,v=e.editing,h=e.onKeyUp,w=this.state.updated,R=this.renderComponent(v,o)||this.renderEditor(v,o,i,a,p)||this.renderViewer(o,i,a,l,f),k=[o.className,"cell",o.overflow,u&&"selected",v&&"editing",o.readOnly&&"read-only",w&&"updated"].filter(function(E){return E}).join(" ");return _e.default.createElement(s,{row:i,col:a,cell:o,selected:u,editing:v,updated:w,attributesRenderer:d,className:k,style:qn(o),onMouseDown:this.handleMouseDown,onMouseOver:this.handleMouseOver,onDoubleClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onKeyUp:h},R)}}]),n}(gt.PureComponent);Ve.default=Ue;Ue.propTypes={row:O.default.number.isRequired,col:O.default.number.isRequired,cell:O.default.shape(Tn.default).isRequired,forceEdit:O.default.bool,selected:O.default.bool,editing:O.default.bool,editValue:O.default.any,clearing:O.default.bool,cellRenderer:O.default.func,valueRenderer:O.default.func.isRequired,dataRenderer:O.default.func,valueViewer:O.default.func,dataEditor:O.default.func,attributesRenderer:O.default.func,onNavigate:O.default.func.isRequired,onMouseDown:O.default.func.isRequired,onMouseOver:O.default.func.isRequired,onDoubleClick:O.default.func.isRequired,onContextMenu:O.default.func.isRequired,onChange:O.default.func.isRequired,onRevert:O.default.func.isRequired,onEdit:O.default.func};Ue.defaultProps={forceEdit:!1,selected:!1,editing:!1,clearing:!1,cellRenderer:Nn.default};Object.defineProperty(je,"__esModule",{value:!0});var Me=Object.assign||function(r){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}return r},Hn=function(){function r(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(n,t,e){return t&&r(n.prototype,t),e&&r(n,e),n}}(),wt=y.exports,ve=J(wt),Un=m.exports,x=J(Un),Yn=ge,zn=J(Yn),Fn=we,Bn=J(Fn),Wn=ce,Xn=J(Wn),Zn=Ve,Gn=J(Zn),Jn=fe,Qn=J(Jn),er=he,tr=J(er),$=U;function J(r){return r&&r.__esModule?r:{default:r}}function nr(r,n){var t={};for(var e in r)n.indexOf(e)>=0||!Object.prototype.hasOwnProperty.call(r,e)||(t[e]=r[e]);return t}function rr(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function ir(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:r}function ar(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}var q=function(n){return Object.keys(n).length===0},le=function(n,t){for(var e=[],i=t-n>0,a=n;i?a<=t:a>=t;i?a++:a--)i?e.push(a):e.unshift(a);return e},or=function(n){return n.split(/\r\n|\n|\r/).map(function(t){return t.split("	")})},Ye=function(r){ar(n,r);function n(t){rr(this,n);var e=ir(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.onMouseDown=e.onMouseDown.bind(e),e.onMouseUp=e.onMouseUp.bind(e),e.onMouseOver=e.onMouseOver.bind(e),e.onDoubleClick=e.onDoubleClick.bind(e),e.onContextMenu=e.onContextMenu.bind(e),e.handleNavigate=e.handleNavigate.bind(e),e.handleKey=e.handleKey.bind(e).bind(e),e.handleCut=e.handleCut.bind(e),e.handleCopy=e.handleCopy.bind(e),e.handlePaste=e.handlePaste.bind(e),e.pageClick=e.pageClick.bind(e),e.onChange=e.onChange.bind(e),e.onRevert=e.onRevert.bind(e),e.isSelected=e.isSelected.bind(e),e.isEditing=e.isEditing.bind(e),e.isClearing=e.isClearing.bind(e),e.handleComponentKey=e.handleComponentKey.bind(e),e.handleKeyboardCellMovement=e.handleKeyboardCellMovement.bind(e),e.defaultState={start:{},end:{},selecting:!1,forceEdit:!1,editing:{},clear:{}},e.state=e.defaultState,e.removeAllListeners=e.removeAllListeners.bind(e),e.handleIEClipboardEvents=e.handleIEClipboardEvents.bind(e),e}return Hn(n,[{key:"removeAllListeners",value:function(){document.removeEventListener("mousedown",this.pageClick),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("cut",this.handleCut),document.removeEventListener("copy",this.handleCopy),document.removeEventListener("paste",this.handlePaste),document.removeEventListener("keydown",this.handleIEClipboardEvents)}},{key:"componentDidMount",value:function(){this.dgDom&&this.dgDom.addEventListener("keydown",this.handleComponentKey)}},{key:"componentWillUnmount",value:function(){this.dgDom&&this.dgDom.removeEventListener("keydown",this.handleComponentKey),this.removeAllListeners()}},{key:"isSelectionControlled",value:function(){return"selected"in this.props}},{key:"getState",value:function(){var e=this.state;if(this.isSelectionControlled()){var i=this.props.selected||{},a=i.start,o=i.end;a=a||this.defaultState.start,o=o||this.defaultState.end,e=Me({},e,{start:a,end:o})}return e}},{key:"_setState",value:function(e){var i=this.props.editModeChanged;if(i&&e.editing){var a=!q(this.state.editing),o=!q(e.editing);a!=o&&i(o)}if(this.isSelectionControlled()&&("start"in e||"end"in e)){var s=e.start,l=e.end,p=nr(e,["start","end"]),f=this.props,d=f.selected,u=f.onSelect;d=d||{},s||(s="start"in d?d.start:this.defaultState.start),l||(l="end"in d?d.end:this.defaultState.end),u&&u({start:s,end:l}),this.setState(p)}else this.setState(e)}},{key:"pageClick",value:function(e){if(!this.props.disablePageClick){var i=this.dgDom;i.contains(e.target)||(this.setState(this.defaultState),this.removeAllListeners())}}},{key:"handleCut",value:function(e){if(q(this.state.editing)){e.preventDefault(),this.handleCopy(e);var i=this.getState(),a=i.start,o=i.end;this.clearSelectedCells(a,o)}}},{key:"handleIEClipboardEvents",value:function(e){e.ctrlKey&&(e.keyCode===67?this.handleCopy(e):e.keyCode===88?this.handleCut(e):(e.keyCode===86||e.which===86)&&this.handlePaste(e))}},{key:"handleCopy",value:function(e){if(q(this.state.editing)){e.preventDefault();var i=this.props,a=i.dataRenderer,o=i.valueRenderer,s=i.data,l=this.getState(),p=l.start,f=l.end;if(this.props.handleCopy)this.props.handleCopy({event:e,dataRenderer:a,valueRenderer:o,data:s,start:p,end:f,range:le});else{var d=le(p.i,f.i).map(function(u){return le(p.j,f.j).map(function(v){var h=s[u][v],w=a?a(h,u,v):null;return w===""||w===null||typeof w>"u"?o(h,u,v):w}).join("	")}).join(`
`);window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",d):e.clipboardData.setData("text/plain",d)}}}},{key:"handlePaste",value:function(e){if(q(this.state.editing)){var i=this.getState(),a=i.start,o=i.end;a={i:Math.min(a.i,o.i),j:Math.min(a.j,o.j)},o={i:Math.max(a.i,o.i),j:Math.max(a.j,o.j)};var s=this.props.parsePaste||or,l=[],p=[];window.clipboardData&&window.clipboardData.getData?p=s(window.clipboardData.getData("Text")):e.clipboardData&&e.clipboardData.getData&&(p=s(e.clipboardData.getData("text/plain")));var f=this.props,d=f.data,u=f.onCellsChanged,v=f.onPaste,h=f.onChange;if(u){var w=[];p.forEach(function(R,k){R.forEach(function(E,g){o={i:a.i+k,j:a.j+g};var _=d[o.i]&&d[o.i][o.j];_?_.readOnly||l.push({cell:_,row:o.i,col:o.j,value:E}):w.push({row:o.i,col:o.j,value:E})})}),w.length?u(l,w):u(l)}else v?(p.forEach(function(R,k){var E=[];R.forEach(function(g,_){o={i:a.i+k,j:a.j+_};var I=d[o.i]&&d[o.i][o.j];E.push({cell:I,data:g})}),l.push(E)}),v(l)):h&&p.forEach(function(R,k){R.forEach(function(E,g){o={i:a.i+k,j:a.j+g};var _=d[o.i]&&d[o.i][o.j];_&&!_.readOnly&&h(_,o.i,o.j,E)})});this._setState({end:o})}}},{key:"handleKeyboardCellMovement",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.getState(),o=a.start,s=a.editing,l=this.props.data,p=s&&!q(s),f=l[o.i]&&l[o.i][o.j];if(p&&!i)return!1;var d=f&&f.component,u=e.which||e.keyCode;if(d&&p){e.preventDefault();return}u===$.TAB_KEY?this.handleNavigate(e,{i:0,j:e.shiftKey?-1:1},!0):u===$.RIGHT_KEY?this.handleNavigate(e,{i:0,j:1}):u===$.LEFT_KEY?this.handleNavigate(e,{i:0,j:-1}):u===$.UP_KEY?this.handleNavigate(e,{i:-1,j:0}):u===$.DOWN_KEY?this.handleNavigate(e,{i:1,j:0}):i&&u===$.ENTER_KEY&&this.handleNavigate(e,{i:e.shiftKey?-1:1,j:0})}},{key:"handleKey",value:function(e){if(!(e.isPropagationStopped&&e.isPropagationStopped())){var i=e.which||e.keyCode,a=this.getState(),o=a.start,s=a.end,l=a.editing,p=l&&!q(l),f=!o||q(o),d=e.ctrlKey||e.metaKey,u=i===$.DELETE_KEY||i===$.BACKSPACE_KEY,v=i===$.ENTER_KEY,h=i>=48&&i<=57,w=i>=65&&i<=90,R=i>=160&&i<=255,k=i>=96&&i<=105,E=!f&&this.props.data[o.i][o.j],g=[187,189,190,107,109,110].indexOf(i)>-1;if(f||d)return!0;p||(this.handleKeyboardCellMovement(e),u?(e.preventDefault(),this.clearSelectedCells(o,s)):E&&!E.readOnly&&(v?(this._setState({editing:o,clear:{},forceEdit:!0}),e.preventDefault()):(h||k||w||R||g)&&this._setState({editing:o,clear:o,forceEdit:!1})))}}},{key:"getSelectedCells",value:function(e,i,a){var o=[];return le(i.i,a.i).map(function(s){le(i.j,a.j).map(function(l){e[s]&&e[s][l]&&o.push({cell:e[s][l],row:s,col:l})})}),o}},{key:"clearSelectedCells",value:function(e,i){var a=this,o=this.props,s=o.data,l=o.onCellsChanged,p=o.onChange,f=this.getSelectedCells(s,e,i).filter(function(d){return!d.cell.readOnly}).map(function(d){return Me({},d,{value:""})});l?(l(f),this.onRevert()):p&&setTimeout(function(){f.forEach(function(d){var u=d.cell,v=d.row,h=d.col,w=d.value;p(u,v,h,w)}),a.onRevert()},0)}},{key:"updateLocationSingleCell",value:function(e){this._setState({start:e,end:e,editing:{}})}},{key:"updateLocationMultipleCells",value:function(e){var i=this.getState(),a=i.start,o=i.end,s=this.props.data,l={i:a.i,j:a.j},p={i:o.i+e.i,j:Math.min(s[0].length-1,Math.max(0,o.j+e.j))};this._setState({start:l,end:p,editing:{}})}},{key:"searchForNextSelectablePos",value:function(e,i,a,o,s){for(var l=function(h){return{i:h.i-1,j:i[0].length-1}},p=function(h){return{i:h.i+1,j:0}},f=function(h){return{i:h.i+o.i,j:h.j+o.j}},d=function(h){var w=h.i,R=h.j;return i[w]&&typeof i[w][R]<"u"},u=f(a);d(u)&&!e(i[u.i][u.j],u.i,u.j);)u=f(u);if(!d(u)){if(!s)return null;o.j<0?u=l(u):u=p(u)}return d(u)&&!e(i[u.i][u.j],u.i,u.j)?this.searchForNextSelectablePos(e,i,u,o,s):d(u)?u:null}},{key:"handleNavigate",value:function(e,i,a){if(i&&(i.i||i.j)){var o=this.props.data,s=this.getState(),l=s.start,p=e.shiftKey&&!a,f=this.props.isCellNavigable?this.props.isCellNavigable:function(){return!0};if(p)this.updateLocationMultipleCells(i);else{var d=this.searchForNextSelectablePos(f,o,l,i,a);d&&this.updateLocationSingleCell(d)}e.preventDefault()}}},{key:"handleComponentKey",value:function(e){var i=this,a=e.which||e.keyCode;if(!![$.ENTER_KEY,$.ESCAPE_KEY,$.TAB_KEY].includes(a)){var o=this.state.editing,s=this.props.data,l=!q(o);if(l){var p=s[o.i][o.j],f=e.shiftKey?-1:1;if(p&&p.component&&!p.forceComponent){e.preventDefault();var d=this.onRevert;a===$.ENTER_KEY?d=function(){return i.handleNavigate(e,{i:f,j:0})}:a===$.TAB_KEY&&(d=function(){return i.handleNavigate(e,{i:0,j:f},!0)}),setTimeout(function(){d(),i.dgDom&&i.dgDom.focus({preventScroll:!0})},1)}}}}},{key:"onContextMenu",value:function(e,i,a){var o=this.props.data[i][a];this.props.onContextMenu&&this.props.onContextMenu(e,o,i,a)}},{key:"onDoubleClick",value:function(e,i){var a=this.props.data[e][i];a.readOnly||this._setState({editing:{i:e,j:i},forceEdit:!0,clear:{}})}},{key:"onMouseDown",value:function(e,i,a){var o=!q(this.state.editing)&&this.state.editing.i===e&&this.state.editing.j===i,s=q(this.state.editing)||this.state.editing.i!==e||this.state.editing.j!==i?{}:this.state.editing;this._setState({selecting:!o,start:a.shiftKey?this.getState().start:{i:e,j:i},end:{i:e,j:i},editing:s,forceEdit:!!o});var l=window.navigator.userAgent,p=/MSIE|Trident/.test(l);p&&document.addEventListener("keydown",this.handleIEClipboardEvents),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousedown",this.pageClick),document.addEventListener("cut",this.handleCut),document.addEventListener("copy",this.handleCopy),document.addEventListener("paste",this.handlePaste)}},{key:"onMouseOver",value:function(e,i){this.state.selecting&&q(this.state.editing)&&this._setState({end:{i:e,j:i}})}},{key:"onMouseUp",value:function(){this._setState({selecting:!1}),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"onChange",value:function(e,i,a){var o=this.props,s=o.onChange,l=o.onCellsChanged,p=o.data;l?l([{cell:p[e][i],row:e,col:i,value:a}]):s&&s(p[e][i],e,i,a),this.onRevert()}},{key:"onRevert",value:function(){var e=this;this._setState({editing:{}}),setTimeout(function(){e.dgDom&&e.dgDom.focus({preventScroll:!0})},1)}},{key:"componentDidUpdate",value:function(e,i){var a=this.state,o=a.start,s=a.end,l=i.end;!q(s)&&!(s.i===l.i&&s.j===l.j)&&!this.isSelectionControlled()&&this.props.onSelect&&this.props.onSelect({start:o,end:s})}},{key:"isSelectedRow",value:function(e){var i=this.getState(),a=i.start,o=i.end,s=a.i,l=o.i;return s<=l?e>=s&&e<=l:e<=s&&e>=l}},{key:"isSelected",value:function(e,i){var a=this.getState(),o=a.start,s=a.end,l=i>=o.j&&i<=s.j,p=i<=o.j&&i>=s.j,f=e>=o.i&&e<=s.i,d=e<=o.i&&e>=s.i;return l&&f||p&&f||p&&d||l&&d}},{key:"isEditing",value:function(e,i){return this.state.editing.i===e&&this.state.editing.j===i}},{key:"isClearing",value:function(e,i){return this.state.clear.i===e&&this.state.clear.j===i}},{key:"render",value:function(){var e=this,i=this.props,a=i.sheetRenderer,o=i.rowRenderer,s=i.cellRenderer,l=i.dataRenderer,p=i.valueRenderer,f=i.dataEditor,d=i.valueViewer,u=i.attributesRenderer,v=i.className,h=i.overflow,w=i.data,R=i.keyFn,k=this.state.forceEdit;return ve.default.createElement("span",{ref:function(g){e.dgDom=g},tabIndex:"0",className:"data-grid-container",onKeyDown:this.handleKey},ve.default.createElement(a,{data:w,className:["data-grid",v,h].filter(function(E){return E}).join(" ")},w.map(function(E,g){return ve.default.createElement(o,{key:R?R(g):g,row:g,cells:E,selected:e.isSelectedRow(g)},E.map(function(_,I){var B=e.isEditing(g,I);return ve.default.createElement(Gn.default,Me({key:_.key?_.key:g+"-"+I,row:g,col:I,cell:_,forceEdit:!1,onMouseDown:e.onMouseDown,onMouseOver:e.onMouseOver,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,onChange:e.onChange,onRevert:e.onRevert,onNavigate:e.handleKeyboardCellMovement,onKey:e.handleKey,selected:e.isSelected(g,I),editing:B,clearing:e.isClearing(g,I),attributesRenderer:u,cellRenderer:s,valueRenderer:p,dataRenderer:l,valueViewer:d,dataEditor:f},B?{forceEdit:k}:{}))}))})))}}]),n}(wt.PureComponent);je.default=Ye;Ye.propTypes={data:x.default.array.isRequired,className:x.default.string,disablePageClick:x.default.bool,overflow:x.default.oneOf(["wrap","nowrap","clip"]),onChange:x.default.func,onCellsChanged:x.default.func,onContextMenu:x.default.func,onSelect:x.default.func,isCellNavigable:x.default.func,selected:x.default.shape({start:x.default.shape({i:x.default.number,j:x.default.number}),end:x.default.shape({i:x.default.number,j:x.default.number})}),valueRenderer:x.default.func.isRequired,dataRenderer:x.default.func,sheetRenderer:x.default.func.isRequired,rowRenderer:x.default.func.isRequired,cellRenderer:x.default.func.isRequired,valueViewer:x.default.func,dataEditor:x.default.func,parsePaste:x.default.func,attributesRenderer:x.default.func,keyFn:x.default.func,handleCopy:x.default.func,editModeChanged:x.default.func};Ye.defaultProps={sheetRenderer:zn.default,rowRenderer:Bn.default,cellRenderer:Xn.default,valueViewer:tr.default,dataEditor:Qn.default};Object.defineProperty(j,"__esModule",{value:!0});j.renderData=j.renderValue=j.ValueViewer=j.DataEditor=j.Cell=j.Row=j.Sheet=void 0;var sr=je,lr=oe(sr),ur=ge,dr=oe(ur),cr=we,fr=oe(cr),hr=ce,pr=oe(hr),mr=fe,vr=oe(mr),br=he,yr=oe(br),Ct=pe;function oe(r){return r&&r.__esModule?r:{default:r}}var gr=j.default=lr.default;j.Sheet=dr.default;j.Row=fr.default;j.Cell=pr.default;j.DataEditor=vr.default;j.ValueViewer=yr.default;j.renderValue=Ct.renderValue;j.renderData=Ct.renderData;function de(r,n){if((n==null?void 0:n._def.typeName)==="ZodBoolean")return Boolean(r);if(r==null||r==="")return null;const t=Number(r);if(n){switch(n._def.typeName==="ZodNullable"?n._def.innerType._def.typeName:n._def.typeName){case"ZodBoolean":return Boolean(r);case"ZodNumber":return Number.isNaN(t)?r:t}return r}return Number.isNaN(t)?r==="Yes"?!0:r==="No"?!1:r:t}function wr(r){return new Promise(n=>{Rt.parse(r,{header:!0,dynamicTyping:!0,worker:!0,skipEmptyLines:!0,complete(t){console.debug("Parsed results:",t),n(t)}})})}function Cr(r){const n=r._def.type._def.shape(),t={};for(const[e,i]of Object.entries(n))i._def.typeName==="ZodNullable"?t[e]={type:rt(i._def.innerType._def.typeName).toLowerCase(),isRequired:!1}:t[e]={type:rt(i._def.typeName).toLowerCase(),isRequired:!0};return t}function rt(r){switch(r){case"ZodString":return"Text";default:return r.replace("Zod","")}}function Er(r){const n=r._def.type._def.shape(),t=Object.keys(n),e={};for(const i of t)e[i]=de(null,n[i]);return[e]}const _r=r=>c("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",role:"img",...r,children:c("path",{d:"M 7 0 L 3 4 L 6 4 L 6 8 L 3 8 C 1.897 8 1 8.897 1 10 L 1 20 C 1 21.103 1.897 22 3 22 L 14.058594 22 C 14.135594 21.305 14.297438 20.638 14.523438 20 L 3 20 L 3 10 L 6.8320312 10 A 1.0001 1.0001 0 0 0 7.1582031 10 L 27 10 L 27.001953 14.947266 C 27.730953 15.310266 28.4 15.766687 29 16.304688 L 29 10 C 29 8.897 28.103 8 27 8 L 8 8 L 8 4 L 11 4 L 7 0 z M 23 16 C 19.134 16 16 19.134 16 23 C 16 26.866 19.134 30 23 30 C 26.866 30 30 26.866 30 23 C 30 19.134 26.866 16 23 16 z M 23 19 C 23.552 19 24 19.447 24 20 L 24 22 L 26 22 C 26.552 22 27 22.447 27 23 C 27 23.553 26.552 24 26 24 L 24 24 L 24 26 C 24 26.553 23.552 27 23 27 C 22.448 27 22 26.553 22 26 L 22 24 L 20 24 C 19.448 24 19 23.553 19 23 C 19 22.447 19.448 22 20 22 L 22 22 L 22 20 C 22 19.447 22.448 19 23 19 z"})}),xr=r=>c("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",role:"img",...r,children:c("path",{d:"M 3 8 C 1.897 8 1 8.897 1 10 L 1 20 C 1 21.103 1.897 22 3 22 L 14.058594 22 C 14.135594 21.305 14.297438 20.638 14.523438 20 L 3 20 L 3 10 L 27 10 L 27.001953 14.947266 C 27.730953 15.310266 28.4 15.766687 29 16.304688 L 29 10 C 29 8.897 28.103 8 27 8 L 3 8 z M 23 16 C 19.134 16 16 19.134 16 23 C 16 26.866 19.134 30 23 30 C 26.866 30 30 26.866 30 23 C 30 19.134 26.866 16 23 16 z M 20 22 L 26 22 C 26.552 22 27 22.447 27 23 C 27 23.553 26.552 24 26 24 L 20 24 C 19.448 24 19 23.553 19 23 C 19 22.447 19.448 22 20 22 z"})}),Mr=r=>c("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",role:"img",...r,children:c("path",{d:"M 3 8 C 1.897 8 1 8.897 1 10 L 1 20 C 1 21.103 1.897 22 3 22 L 14.058594 22 C 14.135594 21.305 14.297438 20.638 14.523438 20 L 3 20 L 3 10 L 27 10 L 27.001953 14.947266 C 27.730953 15.310266 28.4 15.766687 29 16.304688 L 29 10 C 29 8.897 28.103 8 27 8 L 3 8 z M 23 16 C 19.134 16 16 19.134 16 23 C 16 26.866 19.134 30 23 30 C 26.866 30 30 26.866 30 23 C 30 19.134 26.866 16 23 16 z M 23 19 C 23.552 19 24 19.447 24 20 L 24 22 L 26 22 C 26.552 22 27 22.447 27 23 C 27 23.553 26.552 24 26 24 L 24 24 L 24 26 C 24 26.553 23.552 27 23 27 C 22.448 27 22 26.553 22 26 L 22 24 L 20 24 C 19.448 24 19 23.553 19 23 C 19 22.447 19.448 22 20 22 L 22 22 L 22 20 C 22 19.447 22.448 19 23 19 z"})}),Rr=r=>c("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",role:"img",...r,children:c("path",{d:"M27.483,13.752L16.248,2.517c-0.689-0.689-1.807-0.689-2.497,0L2.517,13.752c-0.689,0.689-0.689,1.807,0,2.497 l11.235,11.235c0.689,0.689,1.807,0.689,2.497,0l11.235-11.235C28.172,15.559,28.172,14.441,27.483,13.752z M16.212,8l-0.2,9h-2.024 l-0.2-9H16.212z M15.003,22.189c-0.828,0-1.323-0.441-1.323-1.182c0-0.755,0.494-1.196,1.323-1.196c0.822,0,1.316,0.441,1.316,1.196 C16.319,21.748,15.825,22.189,15.003,22.189z"})}),Sr=r=>c("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",role:"img",...r,children:c("path",{d:"M17,3h2c0.386,0,0.738,0.223,0.904,0.572s0.115,0.762-0.13,1.062L11.292,15l8.482,10.367 c0.245,0.299,0.295,0.712,0.13,1.062S19.386,27,19,27h-2c-0.3,0-0.584-0.135-0.774-0.367l-9-11c-0.301-0.369-0.301-0.898,0-1.267 l9-11C16.416,3.135,16.7,3,17,3z"})}),Y=20;class kr extends gr{}const Re="w-4 h-4 mr-3",Et=F.forwardRef(({id:r,records:n,onChange:t,parseError:e,outputSchema:i,disabled:a},o)=>{const[s,l]=y.exports.useState(0),p=y.exports.useRef(null),[f,d]=y.exports.useState(null),u=y.exports.useMemo(()=>`__IV_SPREADSHEET_EDITOR_${r}`,[r]),v=y.exports.useMemo(()=>i._def.type._def.shape(),[i]),h=y.exports.useMemo(()=>Cr(i),[i]),w=y.exports.useMemo(()=>Object.keys(h),[h]),[R,k]=y.exports.useMemo(()=>{const C=new Map,S=new Set;if(e){for(const N of e.issues)if(N.path.length===2){const[D,L]=N.path;S.add(D);let W=C.get(L);W||(W=new Set,C.set(L,W)),W.add(D)}}return[C,S]},[e]);y.exports.useEffect(()=>{s*Y>n.length&&l(Math.floor(n.length/Y))},[n,s]);const E=y.exports.useCallback((C,S=0)=>C.map((N,D)=>w.map(L=>{var W;return{value:N[L],colDef:h[L],colInvalid:R.has(L),rowInvalid:k.has(D+S),invalid:(W=R.get(L))==null?void 0:W.has(D+S)}})),[w,R,k,h]),g=y.exports.useMemo(()=>{const C=s*Y,S=n.slice(C,C+Y);return E(S,C)},[E,s,n]),_=y.exports.useCallback((C,S)=>{const N=E(n),D=s*Y,L=[...N.map(V=>[...V])];for(const V of C){const X=V.row+D;L[X][V.col].value=V.value}if(S)for(const V of S){let X=L[V.row+D];X||(X=[],L[V.row+D]=X),X[V.col]={value:V.value,colDef:h[V.col]}}const W=L.map(V=>{const X={};return w.forEach((Be,_t)=>{var We,Xe;X[Be]=de((Xe=(We=V[_t])==null?void 0:We.value)!=null?Xe:null,v[Be])}),X});t(W)},[E,n,s,t,h,w,v]),I=y.exports.useCallback(C=>{const S=s*Y,N=[...n];N.splice(C+S,1),t(N)},[t,n,s]),B=y.exports.useCallback(C=>{const S=s*Y,N={};for(const L of w)N[L]=de(null,v[L]);const D=[...n];D.splice(C+S,0,N),t(D)},[t,w,n,v,s]),se=y.exports.useCallback(({children:C,className:S})=>M("table",{className:K(S,"divide-y divide-gray-200 w-full text-sm",{"pointer-events-none":a}),children:[c("thead",{children:c("tr",{children:Object.entries(h).map(([N,D])=>M("th",{className:"bg-blue-50 whitespace-nowrap border text-center py-2 px-2",children:[c("strong",{className:"text-gray-800 block leading-5",children:N}),c("span",{className:"font-mono font-normal text-xs text-gray-500 block leading-5 lowercase",children:`${D.type}${D.isRequired?"*":""}`})]},N))})}),c("tbody",{className:"bg-white divide-y",children:C})]}),[h,a]),Fe=y.exports.useMemo(()=>{const C=[];return e==null||e.issues.forEach(S=>{const[N,D]=S.path,L=Math.ceil(Math.max(1,N)/Y);L!==s+1&&(S.message.includes("received null")?C.push(`Missing value for '${D}' on page ${L}`):C.push(`Invalid value for '${D}' on page ${L}`))}),C},[s,e==null?void 0:e.issues]);return M("div",{className:"text-gray-700 select-none",ref:o,children:[n.length>Y&&c(it,{page:s,setPage:l,totalRecords:n.length}),M("div",{className:"flex justify-between items-center text-sm my-2",children:[c("p",{children:"Expected data format:"}),c("p",{className:"text-gray-500",children:"* indicates required field"})]}),c("div",{className:"max-w-full overflow-auto",children:c(ye,{id:u,disableIfShiftIsPressed:!0,disable:a,children:c(kr,{data:g,onCellsChanged:_,valueRenderer:C=>typeof C.value=="boolean"?C.value?"true":"false":C.value,parsePaste:Dr,sheetRenderer:se,rowRenderer:Nr,cellRenderer:C=>c(Lr,{...C,onAddRow:B}),valueViewer:C=>c(Tr,{...C,onChange:_}),dataEditor:Pr,onContextMenu:(C,S,N,D)=>{d({event:C,cell:S,row:N,col:D})},onSelect:()=>{var C;(C=p.current)==null||C.handleHide({})}})})}),n.length>Y&&c(it,{page:s,setPage:l,totalRecords:n.length,disabled:a}),Fe.length>0&&M("div",{className:"text-sm mt-2",children:[M("p",{className:"flex items-center justify-start",children:[c(Rr,{className:"w-4 h-4 mr-2 text-red-400"}),"This data contains the following errors:"]}),c("ul",{className:"list-disc list-outside ml-10",children:Fe.map((C,S)=>c("li",{children:C},S))})]}),M(Le,{ref:C=>{p.current=C},id:u,onHide:()=>{d(null)},children:[M(ee,{onClick:()=>{!f||(console.log(f),B(f.row))},disabled:!f,children:[c(_r,{className:Re}),"Add row above"]}),M(ee,{onClick:()=>{!f||B(f.row+1)},disabled:!f,children:[c(Mr,{className:Re}),"Add row below"]}),M(ee,{onClick:()=>{!f||I(f.row)},disabled:!f||n.length===1,children:[c(xr,{className:Re}),"Delete row"]})]})]})});Et.displayName="SpreadsheetEditor";const Or=Et;function it({page:r,setPage:n,totalRecords:t,disabled:e}){const i=y.exports.useMemo(()=>Math.ceil(t/Y)-1,[t]);return M("div",{className:"flex flex-wrap justify-between items-center mt-2",children:[M("div",{className:"text-sm",children:["Page ",r+1," of ",i+1]}),M("div",{className:"flex space-x-2 items-start flex-none",children:[c(Z,{theme:"secondary",label:M("span",{className:"flex items-center gap-2",children:[c(Sr,{className:"w-4 h-4 -ml-1 -mr-1.5"}),"Prev"]}),condensed:!0,disabled:r===0||e,onClick:()=>{r!==0&&n(r-1)}}),c(Z,{theme:"secondary",label:M("span",{className:"flex items-center gap-2",children:["Next",c(St,{className:"w-4 h-4 -mr-1 -ml-1.5"})]}),condensed:!0,disabled:r===i||e,onClick:()=>{r>=i||n(r+1)}})]})]})}function Dr(r){return r.trim().split(/\r\n|\n|\r/).map(n=>n.split("	"))}function Nr({children:r}){return c("tr",{children:r})}function Lr({cell:r,children:n,style:t,row:e,col:i,onMouseDown:a,onMouseOver:o,onDoubleClick:s,onContextMenu:l,onAddRow:p,selected:f,editing:d}){const u=y.exports.useRef(null),v=y.exports.useCallback(h=>{(h.metaKey||h.ctrlKey)&&h.key==="Enter"&&p(e+1)},[p,e]);return y.exports.useEffect(()=>(f?window.addEventListener("keydown",v):window.removeEventListener("keydown",v),()=>{window.removeEventListener("keydown",v)}),[v,f]),y.exports.useEffect(()=>{var h;!f||r.colDef.type!=="boolean"||(h=u.current)==null||h.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}))},[f,r.colDef.type]),M("td",{ref:u,className:K("whitespace-nowrap relative text-gray-700 border",{"border-double border-blue-500 bg-blue-50":f||d,"bg-amber-50 text-amber-600":!f&&!d&&r.invalid,"border-solid border-gray-200":!f&&!d,"overflow-hidden":!d,"bg-white z-10":d}),style:t!=null?t:void 0,onMouseDown:a,onMouseOver:o,onDoubleClick:s,onContextMenu:l,"data-row":e,"data-col":i,children:[c("div",{className:"flex leading-4 px-3",children:n}),r.component]})}function Tr({value:r,cell:n,row:t,col:e,onChange:i}){return n.colDef.type==="boolean"?c("span",{className:"w-full flex items-center justify-center",children:c("label",{className:"w-9 flex items-center justify-center cursor-pointer",children:c("input",{type:"checkbox",className:"form-input no-ring",onFocus:a=>a.target.blur(),onMouseDown:()=>{i([{cell:n,row:t,col:e,value:r!=="true"}])},defaultChecked:r==="true"})})}):c("span",{className:"leading-4 block select-none min-w-px py-2",children:r===null||r===""?c(ke,{children:"\xA0"}):r})}function Pr({cell:r,value:n,onChange:t,onKeyDown:e,onRevert:i,onCommit:a}){var v;const o=y.exports.useRef(null),s=y.exports.useRef(null),l=jr(o),p=y.exports.useCallback(h=>{t(h.target.value)},[t]),f=n==="true"||n===!0,d=y.exports.useCallback(h=>{switch(h.key){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":r.colDef.type==="boolean"&&a(n,h);break}r.colDef.type==="boolean"&&!h.metaKey&&!h.ctrlKey&&(h.key==="Enter"||h.code==="Space")&&(t(!f),h.preventDefault())},[r.colDef.type,a,n,t,f]);y.exports.useEffect(()=>(window.addEventListener("keydown",d),()=>{window.removeEventListener("keydown",d)}),[d]);const u=y.exports.useCallback(h=>{switch(h.key){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":r.colDef.type==="boolean"&&(a(n,h),e(h));break;case"Esc":case"Escape":i();break;case"Enter":if(h.metaKey||h.ctrlKey)break;r.colDef.type==="boolean"?(t(!f),a(!f)):a(n,h);break;default:e(h)}},[a,n,e,i,r.colDef.type,t,f]);return c(ke,{children:r.colDef.type==="boolean"?c("span",{className:"w-full flex items-center justify-center",ref:o,children:c("label",{className:"w-9 flex items-center justify-center cursor-pointer",children:c("input",{type:"checkbox",className:"form-input no-ring",onFocus:h=>h.target.blur(),onChange:h=>t(h.target.checked),onKeyDown:u,checked:f,ref:s})})}):M(ke,{children:[c("span",{ref:o,className:"px-3 py-2 absolute left-0 top-0 -translate-x-96 -translate-y-96 whitespace-nowrap",children:n}),c("input",{type:"text",className:"flex-1 text-gray-900 focus:outline-none bg-blue-50 py-2 leading-4 -mt-px",value:n==null?void 0:n.toString(),onChange:p,onKeyDown:u,autoFocus:!0,style:{width:(v=l==null?void 0:l.width)!=null?v:0+12}})]})})}function jr(r){const[n,t]=y.exports.useState(null);return y.exports.useLayoutEffect(()=>{t(r.current.getBoundingClientRect())},[r]),kt(r,e=>{t(e.target.getBoundingClientRect())}),n}const Ir=r=>c("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",role:"img",...r,children:c("path",{d:"M 22.990234 8.9902344 A 1.0001 1.0001 0 0 0 22.292969 10.707031 L 25.585938 14 L 2 14 A 1.0001 1.0001 0 1 0 2 16 L 25.585938 16 L 22.292969 19.292969 A 1.0001 1.0001 0 1 0 23.707031 20.707031 L 28.619141 15.794922 A 1.0001 1.0001 0 0 0 28.623047 14.207031 A 1.0001 1.0001 0 0 0 28.617188 14.203125 L 23.707031 9.2929688 A 1.0001 1.0001 0 0 0 22.990234 8.9902344 z"})}),$r=Ir;function Kr(r){var f;const n=y.exports.useMemo(()=>Te.extractColumns(r.columns),[r.columns]),t=y.exports.useMemo(()=>n._def.type._def.shape(),[n]),e=y.exports.useMemo(()=>Object.keys(n._def.type._def.shape()).map(d=>d.toString()),[n]),[i,a]=y.exports.useState(new Array(e.length).fill(0).map((d,u)=>u)),o=(((f=r.input)==null?void 0:f.meta.fields)||[]).map((d,u)=>({label:d,value:u})),s=e.map((d,u)=>({label:d,value:u})),l=(d,u)=>{a(v=>{const h=[...v];return h[d]=u===null?null:Number(u),h})},p=d=>{if(d&&d.preventDefault(),!r.input)return;const v=r.input.data.map(h=>{const w={},R=Object.values(h);for(let k=0;k<e.length;k++){const E=i[k],g=e[k],_=E===null?null:R[E];w[g]=de(_,t[g])}return w});console.debug("Import result:",v),r.onClose(v)};return c(ot,{title:"Import CSV",dialog:r.dialog,widthClassName:"w-full",children:M("form",{onSubmit:p,children:[M("div",{className:"grid grid-cols-[1fr,50px,1fr,40px] items-center gap-2 text-gray-700 text-sm",children:[c("h4",{className:"text-gray-800 font-medium",children:"Imported fields"}),c("span",{children:"\xA0"}),c("h4",{className:"text-gray-800 font-medium",children:"Expected fields"}),c("h4",{className:"text-gray-800 font-medium",children:"Skip?"}),s.map((d,u)=>M(F.Fragment,{children:[c("div",{children:M("select",{className:"form-select block w-full",onChange:v=>l(u,v.target.value),value:String(i[u]||""),disabled:i[u]===null,"data-testid":`col-select-${u}`,children:[i[u]===null&&c("option",{value:"",children:"--"}),o.map(({label:v,value:h})=>c("option",{value:String(h),children:v},h))]},u)}),c("div",{children:c($r,{className:"text-gray-500 w-4 h-4 block mx-auto mt-1"})}),c("div",{className:"pr-2",children:c("strong",{className:i[u]===null?"opacity-50":"",children:d.label})}),c("div",{children:c(Ot,{id:`skip-${u}`,checked:i[u]===null,onChange:v=>l(u,v.target.checked?null:u)})})]},u))]}),M("div",{className:"border-t border-gray-200 pt-4 mt-6 flex items-start justify-start space-x-2",children:[c(Z,{type:"submit",theme:"primary",onClick:p,label:"Import",tabIndex:0}),c(Z,{theme:"secondary",onClick:()=>r.onClose(null),label:"Cancel",type:"button",tabIndex:1})]})]})})}function Vr(r){var i;const[n,t]=y.exports.useState(!1);y.exports.useEffect(()=>{r.submitAttempted&&t(!0)},[r.submitAttempted]);let e;return n&&(!r.value&&!r.isOptional?e=(i=r.noValueMessage)!=null?i:"This field is required.":r.value instanceof Oe&&(e=r.value.message)),{isTouched:n,setIsTouched:t,errorMessage:e}}const Se=1e3;function Yr(r){const{columns:n}=r,t=y.exports.useMemo(()=>Te.extractColumns(n),[n]),{errorMessage:e}=Vr({...r,noValueMessage:"Please input at least one row before continuing."}),i=y.exports.useRef(null),[a,o]=y.exports.useState(!1),[s,l]=y.exports.useState(null),p=Ge(),f=Ge(),[d,u]=y.exports.useState(null),[v,h]=y.exports.useState(()=>{if(r.data)return r.data;if(r.value&&!(r.value instanceof Oe)){const g=t._def.type._def.shape();return r.value.map(_=>{const I={};for(const[B,se]of Object.entries(_))I[B]=de(se!=null?se:null,g[B]);return I})}return Er(t)}),{onUpdatePendingReturnValue:w}=r;y.exports.useEffect(()=>{if(o(!1),v)try{const g=t.parse(v);if(g.length>Se)throw o(!0),new Error(`Exceeded row limit of ${Se}`);l(null),w(g)}catch(g){Ce.error("Error parsing spreadsheet value",{error:g}),g instanceof at.ZodError?(l(g),w(new Oe("There are one or more issues with the data you entered. Please correct the data and try again."))):(l(null),w(void 0))}else l(null),w(void 0)},[v,t,w,Ce]);const R=g=>{g!=null&&g.length&&h(g),f.hide()},k=g=>{wr(g).then(u).then(()=>{p.hide(),f.show()}).catch(_=>{Ce.error("Error parsing spreadsheet",{error:_})})},E=()=>{var _;const g=(_=i.current)==null?void 0:_.querySelectorAll('td[data-row="0"][data-col="0"]')[0];["mousedown","mouseup","dblclick"].map(I=>{g==null||g.dispatchEvent(new MouseEvent(I,{view:window,bubbles:!0,cancelable:!0}))})};return M("div",{className:"space-y-4",children:[c("h2",{className:"h3 text-gray-900",children:r.label}),M("div",{className:"flex items-start justify-start space-x-2",children:[c(Z,{theme:"secondary",label:"Upload CSV",id:"action-upload",htmlFor:"csv-upload",disabled:r.isSubmitting}),c(Z,{theme:"secondary",label:"Paste data",id:"action-paste",onClick:p.show,disabled:r.isSubmitting}),c(Z,{theme:"secondary",label:"Enter manually",id:"action-manual",onClick:E,disabled:r.isSubmitting}),c("input",{type:"file",accept:".csv",className:"sr-only",id:"csv-upload",disabled:r.isSubmitting,onChange:async g=>{if(!g.target.files)return;const _=g.target.files[0];!_||k(_)}})]}),v&&c(Or,{id:r.id,records:v,onChange:h,parseError:s,outputSchema:t,ref:i,disabled:r.isSubmitting}),a&&M("p",{className:"px-4 py-3 text-sm font-medium text-red-800 rounded-md bg-red-50",children:["Sorry, spreadsheets are currently limited to ",Se," rows."]}),e&&c(Dt,{id:r.id,message:e}),c(Kr,{dialog:f,onClose:R,input:d,columns:r.columns}),c(Ar,{dialog:p,onPaste:k})]})}function Ar({dialog:r,onPaste:n,value:t}){const[e,i]=y.exports.useState(t||"");return y.exports.useEffect(()=>{!r.animating&&!r.visible&&i("")},[r.animating,r.visible]),c(ot,{dialog:r,title:"Paste CSV data",children:M("div",{children:[c("textarea",{className:"form-input block w-full",autoFocus:!0,rows:5,value:e,onChange:a=>i(a.target.value),onPaste:a=>n(a.clipboardData.getData("text/plain"))}),M("div",{className:"border-t border-gray-200 pt-4 mt-6 flex items-start justify-start space-x-2",children:[c(Z,{type:"submit",theme:"primary",onClick:()=>n(e),label:"Next"}),c(Z,{theme:"secondary",onClick:r.hide,label:"Cancel",type:"button"})]})]})})}export{Yr as default};
